"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[9983],{1811(e,n,o){o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"introduction/pwntools","title":"Scripts com Pwntools","description":"Pwntools \xe9 uma biblioteca do python para CTFs feita para desenvolvimento de exploits rapidamente. Ela realmente agiliza bastante o trabalho, e permite enviar inputs para programas ou servidores apenas rodando o arquivo python.","source":"@site/docs/introduction/6-pwntools.md","sourceDirName":"introduction","slug":"/introduction/pwntools","permalink":"/manual-pwning/docs/introduction/pwntools","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Scripts com Pwntools"},"sidebar":"tutorialSidebar","previous":{"title":"Debugging com GDB","permalink":"/manual-pwning/docs/introduction/gdb"},"next":{"title":"Pwning","permalink":"/manual-pwning/docs/pwning/beginning"}}');var r=o(4848),t=o(8453);const i={title:"Scripts com Pwntools"},s=void 0,c={},d=[{value:"Pwntools CheatSheet",id:"pwntools-cheatsheet",level:2}];function l(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Pwntools \xe9 uma biblioteca do python para CTFs feita para desenvolvimento de exploits rapidamente. Ela realmente agiliza bastante o trabalho, e permite enviar inputs para programas ou servidores apenas rodando o arquivo python."}),"\n",(0,r.jsxs)(n.p,{children:["Para instalar, use o comando: ",(0,r.jsx)(n.code,{children:"sudo pip install pwn"})]}),"\n",(0,r.jsx)(n.h2,{id:"pwntools-cheatsheet",children:"Pwntools CheatSheet"}),"\n",(0,r.jsx)(n.p,{children:"O pwntools se baseia na ideia de que podemos enviar inputs a um programa ou servidor, contendo dados que nos levam a manipular o programa como quisermos."}),"\n",(0,r.jsx)(n.p,{children:"O fluxo de uso do Pwntools \xe9:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Estabelecer target (",(0,r.jsx)(n.code,{children:"remote"})," para servidores e ",(0,r.jsx)(n.code,{children:"process"})," para execut\xe1veis locais)"]}),"\n",(0,r.jsxs)(n.li,{children:["Enviar comandos iniciais ao programa com ",(0,r.jsx)(n.code,{children:"gdb.attach()"})," (j\xe1 estabelecemos os breakpoints e quaisquer outros comandos em ",(0,r.jsx)(n.code,{children:"gdbscript"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Gerar dados, empacotar com ",(0,r.jsx)(n.code,{children:"p64()"})," ou ",(0,r.jsx)(n.code,{children:"p32()"})," e enviar com ",(0,r.jsx)(n.code,{children:"target.send()"})," ou ",(0,r.jsx)(n.code,{children:"target.sendline()"})]}),"\n",(0,r.jsxs)(n.li,{children:["Acesso manual com ",(0,r.jsx)(n.code,{children:"target.interactive()"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"from pwn import *\r\n# Conecta a um servidor:porta ao inv\xe9s de faz\xea-lo no terminal\r\ntarget = remote(\"github.com\", 9000);\r\n# Roda um bin\xe1rio (programa!)\r\ntarget = process(\"./challenge\")\r\n# Adicionar o gdb debugger ao processo, dando um comando (b main e b my_function)\r\ngdb.attach(target, gdbscript='''\r\nb main\r\nb my_function')\r\n'''\r\n# Enviar vari\xe1vel x ao target como input\r\ntarget.send(x)\r\n# Enviar vari\xe1vel seguida de um \\n\r\ntarget.sendline(x)\r\n# Printar linha \xfanica de texto do target\r\nprint target.recvline()\r\n# Printar tudo do target at\xe9 a string desejada\r\nprint target.recvuntil(\"out\")\r\n'''\r\n- Arquivos ELFs (assembly) armazenam dados atrav\xe9s de least endian\r\n- Isso que significa que os dados s\xe3o armazenados com o byte menos significativo primeiro. (contra\u0155io)\r\n- (inteiro -> 0x109F D7B4 9C2D 0135 // Armazenado na mem\xf3ria -> 35 01 2D 9C B4 D7 9F 10)\r\n- Em algumas situa\xe7\xf5es em que escaneamos um inteiro, precisamos levar isso em conta.\r\n- Precisamos empacotar o inteiro (human readable -> bin\xe1rio)\r\n'''\r\n# Para empacotar n\xfamero inteiro como least endian (sequ\xeancia de bytes)\r\np64(x) # QWORD (x64 = 64 bits  = 8 bytes)\r\np32(x) # DWORD (x86 = 32 bits = 4 bytes)\r\n# Para desempacotar least endian (sequ\xeancia de bytes) como inteiro\r\nu64(x) # QWORD\r\nu32(x) # DWORD\r\n\r\n# Interage manualmente com o target no terminal\r\ntarget.interactive()\n"})}),"\n",(0,r.jsx)(n.p,{children:"Exemplo de endianness com pwntools:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"# Big endian\r\np64(0x41424344, endian='big')  # b'\\x00\\x00\\x00\\x00ABCD'\r\nu64(b'ABCD\\x00\\x00\\x00\\x00', endian='big')  # 0x41424344\r\n\r\n# Little endian (padr\xe3o)\r\np64(0x41424344)  # b'DCBA\\x00\\x00\\x00\\x00'\r\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Temos que trabalhar com ",(0,r.jsx)(n.code,{children:"b''"}),", um byteArray do python, e n\xe3o strings padr\xe3o ",(0,r.jsx)(n.code,{children:"''"}),". Isso cria uma sequ\xeancia de bytes no Python, essencial para trabalhar com bin\xe1rios, pois bin\xe1rios trabalham com bytes e n\xe3o strings. Comandos como ",(0,r.jsx)(n.code,{children:"p64"})," retornam byteArrays."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"from pwn import *\r\n\r\n# Payload em bytes\r\npayload = b'A' * 64 + p64(0x401234)\r\nconn.send(payload)\n"})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,n,o){o.d(n,{R:()=>i,x:()=>s});var a=o(6540);const r={},t=a.createContext(r);function i(e){const n=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);