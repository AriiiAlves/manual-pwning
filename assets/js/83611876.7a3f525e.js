"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[1015],{2689(e,s,r){r.r(s),r.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>x,frontMatter:()=>a,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"introduction/assembly/assembly","title":"Assembly","description":"O que \xe9 Assembly?","source":"@site/docs/introduction/assembly/2-assembly.mdx","sourceDirName":"introduction/assembly","slug":"/introduction/assembly/assembly","permalink":"/manual-pwning/docs/introduction/assembly/assembly","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Assembly"},"sidebar":"tutorialSidebar","previous":{"title":"Introdu\xe7\xe3o","permalink":"/manual-pwning/docs/introduction/beginning"},"next":{"title":"Stack em Assembly","permalink":"/manual-pwning/docs/introduction/assembly/2-2-stack"}}');var n=r(4848),i=r(8453);const a={title:"Assembly"},o=void 0,l={},t=[{value:"O que \xe9 Assembly?",id:"o-que-\xe9-assembly",level:2},{value:"Por que Assembly?",id:"por-que-assembly",level:2},{value:"Registradores",id:"registradores",level:2},{value:"Flags",id:"flags",level:2},{value:"Instru\xe7\xf5es Assembly comuns",id:"instru\xe7\xf5es-assembly-comuns",level:2},{value:"Words",id:"words",level:3},{value:"Coment\xe1rios",id:"coment\xe1rios",level:3},{value:"mov",id:"mov",level:3},{value:"dereference",id:"dereference",level:3},{value:"lea",id:"lea",level:3},{value:"add",id:"add",level:3},{value:"sub",id:"sub",level:3},{value:"xor",id:"xor",level:3},{value:"push",id:"push",level:3},{value:"pop",id:"pop",level:3},{value:"jmp",id:"jmp",level:3},{value:"call",id:"call",level:3},{value:"ret",id:"ret",level:3},{value:"cmp",id:"cmp",level:3},{value:"jnz/jz (jumpt if not zero/jump if zero)",id:"jnzjz-jumpt-if-not-zerojump-if-zero",level:3}];function c(e){const s={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"o-que-\xe9-assembly",children:"O que \xe9 Assembly?"}),"\n",(0,n.jsxs)(s.p,{children:["Assembly ou linguagem de montagem \xe9 uma ",(0,n.jsx)(s.strong,{children:"linguagem de programa\xe7\xe3o"}),", assim como C, Python, JavaScript, etc. Por\xe9m se destaca por ser a linguagem mais pr\xf3xima do c\xf3digo que o processador realmente executa. O C abstrai muitas das opera\xe7\xf5es."]}),"\n",(0,n.jsxs)(s.p,{children:["Tome como exemplo a opera\xe7\xe3o de declarar uma vari\xe1vel no C: ",(0,n.jsx)(s.code,{children:"int a = 10"}),". Voc\xea acha mesmo que o processador apenas recebe isso e j\xe1 tem um lugar pronto para a vari\xe1vel ",(0,n.jsx)(s.code,{children:"a"}),", uma caixinha onde \xe9 guardado 10? N\xe3o, muito longe disso. Uma s\xe9rie de opera\xe7\xf5es que o processador realmente executa s\xe3o escondidas de voc\xea, para simplificar o trabalho do programador."]}),"\n",(0,n.jsxs)(s.p,{children:["Algumas linguagens de programa\xe7\xe3o abstraem mais do que outras. O Assembly \xe9 ",(0,n.jsx)(s.strong,{children:"muito pr\xf3ximo do c\xf3digo de m\xe1quina, muito verboso"}),'. O C j\xe1 abstrai mais, mas \xe9 r\xedgido e permite manipula\xe7\xe3o de mem\xf3ria. J\xe1 o Python seria o "n\xedvel mais f\xe1cil" das linguagens de programa\xe7\xe3o, pois tem in\xfameras funcionalidades prontas que facilitam seu trabalho.']}),"\n",(0,n.jsx)(s.p,{children:"Podemos ver isso com a opera\xe7\xe3o de soma de dois n\xfameros."}),"\n",(0,n.jsx)(s.p,{children:"C\xf3digo de m\xe1quina:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-Bin",children:"01001000 11000111 11000111 00000101 00000000 00000000 00000000\r\n01001000 11000111 11000110 00000011 00000000 00000000 00000000\r\n01001000 00000001 11110111\n"})}),"\n",(0,n.jsxs)(s.p,{children:["C\xf3digo de m\xe1quina em hexadecimal (cada hexadecimal representa 1 byte. Se acostume com isso, pois analisamos informa\xe7\xf5es na mem\xf3ria desse jeito, o famoso ",(0,n.jsx)(s.code,{children:"hexdump"}),"):"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-hex",children:"48 c7 c7 05 00 00 00 48 c7 c6 03 00 00 00 48 01 f7\n"})}),"\n",(0,n.jsx)(s.p,{children:"C\xf3digo em Assembly:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-Assembly",children:"mov rdi, 0x5\r\nmov rsi, 0x3 \r\nadd rdi, rsi\n"})}),"\n",(0,n.jsx)(s.p,{children:"C\xf3digo em C:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-C",children:"int a = 5;\r\nint b = 3;\r\nint resultado = a + b;\n"})}),"\n",(0,n.jsx)(s.p,{children:"C\xf3digo em Python:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-py",children:"resultado = 5 + 3\n"})}),"\n",(0,n.jsx)(s.p,{children:"N\xe3o h\xe1 linguagem de programa\xe7\xe3o melhor do que outra, apenas aquela que \xe9 uma ferramenta boa para voc\xea. Python oferece agilidade, enquanto C oferece otimiza\xe7\xe3o e robustez, ao passo que Assembly \xe9 pr\xf3xima do c\xf3digo de m\xe1quina, \xfatil para otimiza\xe7\xe3o e tamb\xe9m an\xe1lise de Engenharia Reversa, como veremos aqui."}),"\n",(0,n.jsxs)(s.p,{children:["O Assembly possui ",(0,n.jsx)(s.strong,{children:"acesso direto ao hardware"}),", de modo que permite manipular diretamente os registradores da CPU (falaremos mais \xe0 frente sobre isso). Cada instru\xe7\xe3o (linha) de um c\xf3digo Assembly geralmente corresponde a uma \xfanica instru\xe7\xe3o de m\xe1quina, assim temos uma propor\xe7\xe3o 1:1, algo que n\xe3o acontece no C e Python."]}),"\n",(0,n.jsx)(s.h2,{id:"por-que-assembly",children:"Por que Assembly?"}),"\n",(0,n.jsx)(s.p,{children:"Todo c\xf3digo, qualquer que seja a linguagem, \xe9 compilado e transformado em c\xf3digo de m\xe1quina. Engenharia reversa \xe9 a arte de abrir esses bin\xe1rios e entend\xea-los, e para isso precisamos entender a sintaxe do Assembly, pois ela torna o c\xf3digo de m\xe1quina leg\xedvel. Ou seja, ela traduz 0 e 1 em instru\xe7\xf5es que podemos entender. O assembly n\xe3o \xe9 t\xe3o trivial, mas uma vez que voc\xea se acostuma, te ajuda perfeitamente a entender quealquer bin\xe1rio."}),"\n",(0,n.jsx)(s.p,{children:"Al\xe9m disso, as vulnerabilidades que s\xe3o exploradas aqui e em CTF's geralmente necessitam que  exploremos o Assembly e a organiza\xe7\xe3o interna do c\xf3digo, para ver como podemos abusar dessa estrutura."}),"\n",(0,n.jsx)(s.h2,{id:"registradores",children:"Registradores"}),"\n",(0,n.jsxs)(s.p,{children:["Registradores s\xe3o ",(0,n.jsx)(s.strong,{children:"locais de mem\xf3ria tempor\xe1ria dentro do processador"}),". Eles possuem uma ",(0,n.jsx)(s.strong,{children:"quantidade pequena de mem\xf3ria"}),", em geral 8 bytes, mas possuem ",(0,n.jsx)(s.strong,{children:"alta velocidade de acesso e opera\xe7\xe3o"})," (muito mais r\xe1pido que mem\u1e3foria RAM)."]}),"\n",(0,n.jsx)(s.p,{children:"Basicamente, os registradores s\xe3o utilizados para armazenar informa\xe7\xe3o \xfatil, como valores de vari\xe1veis, endere\xe7os de mem\xf3ria para outros lugares (ponteiros), etc. Os registradores sempre estar\xe3o presentes em c\xf3digo assembly, pois enviar valores diretamente para registradores no processador \xe9 o modo mais otimizado de se realizar uma opera\xe7\xe3o."}),"\n",(0,n.jsx)("div",{style:{textAlign:"center"},children:(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"Simple Stack",src:r(5831).A+"",width:"294",height:"323"})})}),"\n",(0,n.jsxs)(s.p,{children:["Na ",(0,n.jsx)(s.strong,{children:"arquitetura x64 (64 bits = 8 bytes)"}),", os registradores da CPU do computador ",(0,n.jsx)(s.strong,{children:"possuem 8 bytes cada"}),". Na ",(0,n.jsx)(s.strong,{children:"arquitetura x86 (32 bits = 4 bytes)"}),", os registradores possuem ",(0,n.jsx)(s.strong,{children:"4 bytes cada"}),". Cada programa ",(0,n.jsx)(s.strong,{children:".exe"})," (ou qualquer outra extens\xe3o em c\xf3digo de m\xe1quina) segue uma dessas duas arquiteturas."]}),"\n",(0,n.jsx)(s.p,{children:"Abaixo, temos uma lista de registradores e do modo como cada um \xe9 usado em um programa."}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"8 Byte Register"}),(0,n.jsx)(s.th,{children:"Lower 4 Bytes"}),(0,n.jsx)(s.th,{children:"Lower 2 Bytes"}),(0,n.jsx)(s.th,{children:"Lower Byte"}),(0,n.jsx)(s.th,{children:"Uso principal"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rbp"}),(0,n.jsx)(s.td,{children:"ebp"}),(0,n.jsx)(s.td,{children:"bp"}),(0,n.jsx)(s.td,{children:"bpl"}),(0,n.jsx)(s.td,{children:"Base Pointer (Ponteiro de Base do Frame da Pilha)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rsp"}),(0,n.jsx)(s.td,{children:"esp"}),(0,n.jsx)(s.td,{children:"sp"}),(0,n.jsx)(s.td,{children:"spl"}),(0,n.jsx)(s.td,{children:"Stack Pointer (Ponteiro do Topo da Pilha)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rip"}),(0,n.jsx)(s.td,{children:"eip"}),(0,n.jsx)(s.td,{children:"(N/A)"}),(0,n.jsx)(s.td,{children:"(N/A)"}),(0,n.jsx)(s.td,{children:"Instruction Pointer (Ponteiro da Pr\xf3xima Instru\xe7\xe3o)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rax"}),(0,n.jsx)(s.td,{children:"eax"}),(0,n.jsx)(s.td,{children:"ax"}),(0,n.jsx)(s.td,{children:"al"}),(0,n.jsx)(s.td,{children:"Acumulador (Valor de Retorno, Opera\xe7\xf5es Aritm\xe9ticas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rbx"}),(0,n.jsx)(s.td,{children:"ebx"}),(0,n.jsx)(s.td,{children:"bx"}),(0,n.jsx)(s.td,{children:"bl"}),(0,n.jsx)(s.td,{children:"Base (Ponteiro de Dados, Valor Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rcx"}),(0,n.jsx)(s.td,{children:"ecx"}),(0,n.jsx)(s.td,{children:"cx"}),(0,n.jsx)(s.td,{children:"cl"}),(0,n.jsx)(s.td,{children:"Contador (Contador para Loops/Shifts, 3\xba Argumento)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rdx"}),(0,n.jsx)(s.td,{children:"edx"}),(0,n.jsx)(s.td,{children:"dx"}),(0,n.jsx)(s.td,{children:"dl"}),(0,n.jsx)(s.td,{children:"Dados (Extens\xe3o do Acumulador, 4\xba Argumento)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rsi"}),(0,n.jsx)(s.td,{children:"esi"}),(0,n.jsx)(s.td,{children:"si"}),(0,n.jsx)(s.td,{children:"sil"}),(0,n.jsx)(s.td,{children:"Source Index (Ponteiro Fonte para Opera\xe7\xf5es de String/Mem\xf3ria, 2\xba Argumento)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"rdi"}),(0,n.jsx)(s.td,{children:"edi"}),(0,n.jsx)(s.td,{children:"di"}),(0,n.jsx)(s.td,{children:"dil"}),(0,n.jsx)(s.td,{children:"Destination Index (Ponteiro Destino para String/Mem\xf3ria, 1\xba Argumento)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r8"}),(0,n.jsx)(s.td,{children:"r8d"}),(0,n.jsx)(s.td,{children:"r8w"}),(0,n.jsx)(s.td,{children:"r8b"}),(0,n.jsx)(s.td,{children:"5\xba Argumento de Fun\xe7\xe3o (Uso Geral)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r9"}),(0,n.jsx)(s.td,{children:"r9d"}),(0,n.jsx)(s.td,{children:"r9w"}),(0,n.jsx)(s.td,{children:"r9b"}),(0,n.jsx)(s.td,{children:"6\xba Argumento de Fun\xe7\xe3o (Uso Geral)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r10"}),(0,n.jsx)(s.td,{children:"r10d"}),(0,n.jsx)(s.td,{children:"r10w"}),(0,n.jsx)(s.td,{children:"r10b"}),(0,n.jsx)(s.td,{children:"Tempor\xe1rio (Uso Geral, N\xe3o Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r11"}),(0,n.jsx)(s.td,{children:"r11d"}),(0,n.jsx)(s.td,{children:"r11w"}),(0,n.jsx)(s.td,{children:"r11b"}),(0,n.jsx)(s.td,{children:"Tempor\xe1rio (Uso Geral, N\xe3o Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r12"}),(0,n.jsx)(s.td,{children:"r12d"}),(0,n.jsx)(s.td,{children:"r12w"}),(0,n.jsx)(s.td,{children:"r12b"}),(0,n.jsx)(s.td,{children:"Local (Uso Geral, Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r13"}),(0,n.jsx)(s.td,{children:"r13d"}),(0,n.jsx)(s.td,{children:"r13w"}),(0,n.jsx)(s.td,{children:"r13b"}),(0,n.jsx)(s.td,{children:"Local (Uso Geral, Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r14"}),(0,n.jsx)(s.td,{children:"r14d"}),(0,n.jsx)(s.td,{children:"r14w"}),(0,n.jsx)(s.td,{children:"r14b"}),(0,n.jsx)(s.td,{children:"Local (Uso Geral, Preservado em Chamadas)"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"r15"}),(0,n.jsx)(s.td,{children:"r15d"}),(0,n.jsx)(s.td,{children:"r15w"}),(0,n.jsx)(s.td,{children:"r15b"}),(0,n.jsx)(s.td,{children:"Local (Uso Geral, Preservado em Chamadas)"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"OBS: O modo como os registradores s\xe3o usados como argumentos de fun\xe7\xf5es mudam para cada arquitetura. Mais adiante explicaremos o que \xe9 Stack."}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Arquitetura e Sistema Operacional"}),(0,n.jsx)(s.th,{children:"Conven\xe7\xe3o de Chamada"}),(0,n.jsx)(s.th,{children:"Registradores para Par\xe2metros (Inteiros/Ponteiros)"}),(0,n.jsx)(s.th,{children:"Par\xe2metros Excedentes"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"x86-64 (Linux/macOS/BSD)"})}),(0,n.jsx)(s.td,{children:"System V AMD64 ABI"}),(0,n.jsx)(s.td,{children:"1\xba: RDI"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"2\xba: RSI"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"3\xba: RDX"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"4\xba: RCX"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"5\xba: R8"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"6\xba: R9"}),(0,n.jsx)(s.td,{children:"V\xe3o para a Stack (push da direita para esquerda)."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"x86-64 (Windows)"})}),(0,n.jsx)(s.td,{children:"Microsoft x64 ABI"}),(0,n.jsx)(s.td,{children:"1\xba: RCX"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"2\xba: RDX"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"3\xba: R8"}),(0,n.jsx)(s.td,{})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{}),(0,n.jsx)(s.td,{children:"4\xba: R9"}),(0,n.jsx)(s.td,{children:'V\xe3o para a Stack. Espa\xe7o de "shadow store" \xe9 reservado na pilha para os primeiros quatro par\xe2metros, mesmo que a fun\xe7\xe3o n\xe3o use par\xe2metros.'})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"x86 (32-bit)"})}),(0,n.jsx)(s.td,{children:"cdecl (Linux)"}),(0,n.jsx)(s.td,{children:"Todos os par\xe2metros v\xe3o para a Stack (push da direita para esquerda)."}),(0,n.jsx)(s.td,{children:"N\xe3o se aplica."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"x86 (32-bit)"})}),(0,n.jsx)(s.td,{children:"stdcall (WinAPI)"}),(0,n.jsx)(s.td,{children:"Todos os par\xe2metros v\xe3o para a Stack (push da direita para esquerda)."}),(0,n.jsx)(s.td,{children:"N\xe3o se aplica."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"ARM (AArch64)"})}),(0,n.jsx)(s.td,{children:"AAPCS64"}),(0,n.jsx)(s.td,{children:"1\xba-8\xba: X0-X7"}),(0,n.jsx)(s.td,{children:"V\xe3o para a pilha."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"ARM (AArch32)"})}),(0,n.jsx)(s.td,{children:"AAPCS"}),(0,n.jsx)(s.td,{children:"1\xba-4\xba: R0-R3"}),(0,n.jsx)(s.td,{children:"V\xe3o para a pilha."})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"Neste guia, utilizaremos a conven\xe7\xe3o Linux de 32-bit e 64-bit para analisar registradores e stack. Mas o que muda \xe9 apenas a conven\xe7\xe3o."}),"\n",(0,n.jsx)(s.h2,{id:"flags",children:"Flags"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Existe um registrador que cont\xe9m flags"}),", o ",(0,n.jsx)(s.strong,{children:"RFLAGS"})," (x64 = 64 bits) ou ",(0,n.jsx)(s.strong,{children:"EFLAGS"})," (x86 = 32 bits). Cada bit do registrador \xe9 uma flag diferente."]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Bit"}),(0,n.jsx)(s.th,{children:"Flag"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"00"}),(0,n.jsx)(s.td,{children:"Carry Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"01"}),(0,n.jsx)(s.td,{children:"always 1"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"02"}),(0,n.jsx)(s.td,{children:"Parity Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"03"}),(0,n.jsx)(s.td,{children:"always 0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"04"}),(0,n.jsx)(s.td,{children:"Adjust Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"05"}),(0,n.jsx)(s.td,{children:"always 0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"06"}),(0,n.jsx)(s.td,{children:"Zero Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"07"}),(0,n.jsx)(s.td,{children:"Sign Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"08"}),(0,n.jsx)(s.td,{children:"Trap Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"09"}),(0,n.jsx)(s.td,{children:"Interruption Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"10"}),(0,n.jsx)(s.td,{children:"Direction Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"11"}),(0,n.jsx)(s.td,{children:"Overflow Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"12"}),(0,n.jsx)(s.td,{children:"I/O Privilege Field lower bit"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"13"}),(0,n.jsx)(s.td,{children:"I/O Privilege Field higher bit"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"14"}),(0,n.jsx)(s.td,{children:"Nested Task Flag"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"15"}),(0,n.jsx)(s.td,{children:"Resume Flag"})]})]})]}),"\n",(0,n.jsxs)(s.p,{children:["Esse registrador \xe9 usado, por exemplo, para a opera\xe7\xe3o de comparar se dois n\xfameros s\xe3o iguais. Para verificar se ",(0,n.jsx)(s.code,{children:"a > b"}),":"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"cmp a, b"})," (instru\xe7\xe3o assembly)","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Faz ",(0,n.jsx)(s.code,{children:"a - b"})]}),"\n",(0,n.jsxs)(s.li,{children:["Se d\xe1 zero, ",(0,n.jsx)(s.strong,{children:"Zero Flag"})," (bit 06) fica como ",(0,n.jsx)(s.code,{children:"1"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Se d\xe1 diferente de zero, ",(0,n.jsx)(s.strong,{children:"Zero Flag"})," (bit 06) fica como ",(0,n.jsx)(s.code,{children:"0"}),".","\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Se d\xe1 negativo, ",(0,n.jsx)(s.strong,{children:"Sign Flag"})," (bit 07) fica como ",(0,n.jsx)(s.code,{children:"1"})]}),"\n",(0,n.jsxs)(s.li,{children:["Se d\xe1 positivo, ",(0,n.jsx)(s.strong,{children:"Sign Flag"})," (bit 07) fica como ",(0,n.jsx)(s.code,{children:"0"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.li,{children:"Resultado da subtra\xe7\xe3o \xe9 descartado, mas as Flags s\xe3o utilizadas como refer\xeancia para os pr\xf3ximos passos."}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Isso sempre ir\xe1 ocorrer quando houver um ",(0,n.jsx)(s.code,{children:"IF/ELSE"}),", por exemplo, no c\xf3digo original."]}),"\n",(0,n.jsx)(s.h2,{id:"instru\xe7\xf5es-assembly-comuns",children:"Instru\xe7\xf5es Assembly comuns"}),"\n",(0,n.jsx)(s.h3,{id:"words",children:"Words"}),"\n",(0,n.jsx)(s.p,{children:"Words n\xe3o s\xe3o comandos, mas indicam o tamanho do tipo de dado em Assembly."}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["WORD = ",(0,n.jsx)(s.strong,{children:"2 bytes de dados"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["DWORD = ",(0,n.jsx)(s.strong,{children:"4 bytes de dados"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["QWORD = ",(0,n.jsx)(s.strong,{children:"8 bytes de dados"}),"."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"coment\xe1rios",children:"Coment\xe1rios"}),"\n",(0,n.jsxs)(s.p,{children:["Para coment\xe1rios, usa-se ",(0,n.jsx)(s.code,{children:";"})]}),"\n",(0,n.jsx)(s.h3,{id:"mov",children:"mov"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Move dados de um registrador para outro"})," (segundo para o primeiro)."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"mov rax, rdx"})," (move dados de rdx para rax)"]}),"\n",(0,n.jsx)(s.h3,{id:"dereference",children:"dereference"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"colchetes referenciam dados ao qual um ponteiro aponta"}),". Ou seja, se ",(0,n.jsx)(s.code,{children:"RBP-0x8"})," = ",(0,n.jsx)(s.code,{children:"0xfffff72c"})," (endere\xe7o), ent\xe3o ",(0,n.jsx)(s.code,{children:"[RBP-0x8]"})," = 10 (valor da vari\xe1vel)."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"mov rax, [rdx]"})]}),"\n",(0,n.jsx)(s.h3,{id:"lea",children:"lea"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Calcula o endere\xe7o do segundo operando"}),", e move para o primeiro."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"lea rdi, [rbx+0x10]"})," (move o endere\xe7o rbx+0x10 para o registrador rdi)"]}),"\n",(0,n.jsx)(s.h3,{id:"add",children:"add"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Adiciona dois valores"})," e armazena no primeiro operando."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"add rax, rdx"})," (rax = rax + rdx)"]}),"\n",(0,n.jsx)(s.h3,{id:"sub",children:"sub"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Subtrai o segundo operando do primeiro"})," e armazena no primeiro."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"sub rsp, 0x10"})," (",(0,n.jsx)(s.code,{children:"rsp"})," = ",(0,n.jsx)(s.code,{children:"rsp"})," - ",(0,n.jsx)(s.code,{children:"0x10"}),")"]}),"\n",(0,n.jsx)(s.h3,{id:"xor",children:"xor"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Faz o xor nos dois argumentos"}),", e armazena no primeiro operando. and e or s\xe3o semelhantes."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"xor rdx, rax"})]}),"\n",(0,n.jsx)(s.h3,{id:"push",children:"push"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Cresce a stack em 8 ou 4 bytes"})," (para x64, ou 4 para x86), ",(0,n.jsx)(s.strong,{children:"depois"})," ",(0,n.jsx)(s.strong,{children:"adiciona o conte\xfado do registrador para o topo da stack"})]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"push rax"})]}),"\n",(0,n.jsx)(s.h3,{id:"pop",children:"pop"}),"\n",(0,n.jsx)(s.p,{children:"Tira 8 bytes do topo da stack e armazena no argumento. Depois encolhe a stack."}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"pop rax"})," (Retira dado do topo da Stack e armazena em RAX)"]}),"\n",(0,n.jsx)(s.h3,{id:"jmp",children:"jmp"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Pula para um endere\xe7o de instru\xe7\xe3o"}),". Redireciona a execu\xe7\xe3o do c\xf3digo."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"jmp 0x60201012"})]}),"\n",(0,n.jsx)(s.p,{children:"\xc9 uma redu\xe7\xe3o de c\xf3digo, e \xe9 igual a:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"mov RIP, 0x60201012"})}),"\n",(0,n.jsx)(s.p,{children:"(Alterar o RIP altera onde o c\xf3digo estar\xe1 sendo executado)"}),"\n",(0,n.jsx)(s.h3,{id:"call",children:"call"}),"\n",(0,n.jsx)(s.p,{children:"\xc9 uma redu\xe7\xe3o de dois comandos. Utilizado sempre que se chama uma fun\xe7\xe3o no c\xf3digo."}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"push RIP"})," - empilha Return Address na stack. \xc9 o endere\xe7o de retorno da PR\xd3XIMA instru\xe7\xe3o a ser executada na fun\xe7\xe3o atual quando a nova fun\xe7\xe3o retornar."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"jmp function"}),"- Salta para as linhas de instru\xe7\xe3o da nova fun\xe7\xe3o."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"ret",children:"ret"}),"\n",(0,n.jsxs)(s.p,{children:["Depois que a fun\xe7\xe3o finaliza, ",(0,n.jsxs)(s.strong,{children:["a instru\xe7\xe3o ",(0,n.jsx)(s.code,{children:"ret"})," \xe9 chamada"]}),". Ela consiste em uma redu\xe7\xe3o de comando:"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"pop RIP"})," - Desempilha topo da stack (que deve ser o return address) e coloca no RIP (registrador que guarda o endere\xe7o de onde est\xe1 sendo executado c\xf3digo)"]}),"\n",(0,n.jsx)(s.p,{children:"Voc\xea pode se perguntar: Mas o topo da stack n\xe3o tem as vari\xe1veis, RBP antigo, etc? Sim, exato. Por isso, antes da fun\xe7\xe3o finalizar, temos ajustes na stack:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-assembly",children:"mov RBP, RSP ; RSP (topo da stack) agora \xe9 RBP, que cont\xe9m endere\xe7o do RBP da fun\xe7\xe3o anterior\r\n\r\npop RBP ; Faz o pop, restaurando o endere\xe7o do RBP da fun\xe7\xe3o anterior\r\nret\n"})}),"\n",(0,n.jsxs)(s.p,{children:["(OBS: ",(0,n.jsx)(s.code,{children:";"})," \xe9 um ",(0,n.jsx)(s.strong,{children:"coment\xe1rio"})," em assembly)"]}),"\n",(0,n.jsx)(s.p,{children:"E o que acontece com as vari\xe1veis e todas as outras coisas que estavam na stack da fun\xe7\xe3o? Ficam l\xe1, como lixo de mem\xf3ria, sem serem modificadas, at\xe9 que um programa sobrescreva elas."}),"\n",(0,n.jsx)(s.h3,{id:"cmp",children:"cmp"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Compara dois operandos, faz o primeiro menos o segundo e checa se o resultado \xe9 maior/menor/igual a zero"}),". Dependendo do valor, define uma flag de acordo."]}),"\n",(0,n.jsxs)(s.p,{children:["Ex: ",(0,n.jsx)(s.code,{children:"cmp RAX, 0x10"})]}),"\n",(0,n.jsx)(s.h3,{id:"jnzjz-jumpt-if-not-zerojump-if-zero",children:"jnz/jz (jumpt if not zero/jump if zero)"}),"\n",(0,n.jsxs)(s.p,{children:["Similar ao ",(0,n.jsx)(s.code,{children:"jmp"}),". Mas apenas executa dependendo do status da zero flag."]}),"\n",(0,n.jsxs)(s.p,{children:["Existem outros, como ",(0,n.jsx)(s.code,{children:"jle"})," (jump if less or equal)."]})]})}function x(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},5831(e,s,r){r.d(s,{A:()=>d});const d=r.p+"assets/images/registers-fb046b686afdc7db766d6689d41748e8.png"},8453(e,s,r){r.d(s,{R:()=>a,x:()=>o});var d=r(6540);const n={},i=d.createContext(n);function a(e){const s=d.useContext(i);return d.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),d.createElement(i.Provider,{value:s},e.children)}}}]);