"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[389],{3422(e,n,o){o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"fast-food/pwning/format-strings","title":"Format Strings","description":"Explora\xe7\xe3o de printf ou sprintf que aceitam a entrada do usu\xe1rio diretamente como string de formato (%s, %x, %n). Permite vazar endere\xe7o ou escrever GOT/vari\xe1veis.","source":"@site/docs/fast-food/pwning/6-format-strings.md","sourceDirName":"fast-food/pwning","slug":"/fast-food/pwning/format-strings","permalink":"/manual-pwning/docs/fast-food/pwning/format-strings","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Format Strings"}}');var i=o(4848),t=o(8453);const s={title:"Format Strings"},a=void 0,c={},d=[{value:"printf",id:"printf",level:2}];function l(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Explora\xe7\xe3o de printf ou sprintf que aceitam a entrada do usu\xe1rio diretamente como string de formato (",(0,i.jsx)(n.code,{children:"%s"}),", ",(0,i.jsx)(n.code,{children:"%x"}),", ",(0,i.jsx)(n.code,{children:"%n"}),"). Permite vazar endere\xe7o ou escrever GOT/vari\xe1veis."]}),"\n",(0,i.jsx)(n.h2,{id:"printf",children:"printf"}),"\n",(0,i.jsxs)(n.p,{children:["Permite vazar TODA a pilha, pois imprime em sequ\xeancia tudo que estiver ap\xf3s ESP/RSP antes de chamar ",(0,i.jsx)(n.code,{children:"printf"}),"."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Identifique se h\xe1 ",(0,i.jsx)(n.code,{children:"printf"})," onde o primeiro argumento \xe9 seu input"]}),"\n",(0,i.jsxs)(n.li,{children:["Se houver, voc\xea pode usar format strings como input: ",(0,i.jsx)(n.code,{children:"%x %x %x %x"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"%x"})," - Mostra conte\xfado do bloco de mem\xf3ria em hexadecimal. Se o conte\xfado for um endere\xe7o, vai imprimir."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"%s"})," - Imprime caracteres em v\xe1rios blocos de mem\xf3ria at\xe9 encontrar ",(0,i.jsx)(n.code,{children:"\\0"}),". L\xea o valor no endere\xe7o de mem\xf3ria que foi passado ao %s."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"%n"})," - Escreve no endere\xe7o o n\xfamero de bytes impressos at\xe9 agora. (",(0,i.jsx)(n.code,{children:'printf("Hello%n", &count);'})," => count = 5 no final)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"%p"})," - Retorna a mesma coisa do ",(0,i.jsx)(n.code,{children:"%x"}),", mas com ",(0,i.jsx)(n.code,{children:"0x"})," na frente"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\xdatil: par\xe2metro arbitr\xe1rio -> ",(0,i.jsx)(n.code,{children:'printf("%6$x);'})," imprime o 6\xba par\xe2metro (Ex: Sabemos que Canary est\xe1 l\xe1)"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,n,o){o.d(n,{R:()=>s,x:()=>a});var r=o(6540);const i={},t=r.createContext(i);function s(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);