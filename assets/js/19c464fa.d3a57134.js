"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[3461],{7319(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>t,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"introduction/gdb","title":"Debugging com GDB","description":"GDB, um debbuger do GNU, \xe9 uma \xf3tima ferramenta para analisar bin\xe1rios em execu\xe7\xe3o, permitindo analisar o c\xf3digo em assembly, ler vari\xe1veis na mem\xf3ria, ler a stack, etc. \xc9 realmente essencial para se trabalhar com rev.","source":"@site/docs/introduction/5-gdb.md","sourceDirName":"introduction","slug":"/introduction/gdb","permalink":"/manual-pwning/docs/introduction/gdb","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Debugging com GDB"},"sidebar":"tutorialSidebar","previous":{"title":"Ghidra","permalink":"/manual-pwning/docs/introduction/ghidra"},"next":{"title":"Scripts com Pwntools","permalink":"/manual-pwning/docs/introduction/pwntools"}}');var o=s(4848),i=s(8453);const d={title:"Debugging com GDB"},a=void 0,l={},c=[{value:"Instalando e executando",id:"instalando-e-executando",level:2},{value:"Como usar",id:"como-usar",level:2},{value:"Breakpoints",id:"breakpoints",level:3},{value:"Console de debug",id:"console-de-debug",level:3},{value:"Registers",id:"registers",level:4},{value:"Stack",id:"stack",level:4},{value:"Code",id:"code",level:4},{value:"Arguments (guessed)",id:"arguments-guessed",level:4},{value:"Threads",id:"threads",level:4},{value:"Trace",id:"trace",level:4},{value:"Visualizando",id:"visualizando",level:3},{value:"Mudando valores",id:"mudando-valores",level:3},{value:"Arquivos compilados e Debugging symbols",id:"arquivos-compilados-e-debugging-symbols",level:2},{value:"Compilando com -g",id:"compilando-com--g",level:3},{value:"Compilando sem -g",id:"compilando-sem--g",level:3},{value:"Compilando sem -g + stripped",id:"compilando-sem--g--stripped",level:3},{value:"Verificando n\xedvel de strip de um bin\xe1rio",id:"verificando-n\xedvel-de-strip-de-um-bin\xe1rio",level:3},{value:"Observa\xe7\xe3o: C\xf3digos n\xe3o iniciam na main",id:"observa\xe7\xe3o-c\xf3digos-n\xe3o-iniciam-na-main",level:2}];function x(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["GDB, um debbuger do GNU, \xe9 uma \xf3tima ferramenta para ",(0,o.jsx)(n.strong,{children:"analisar bin\xe1rios em execu\xe7\xe3o"}),", permitindo analisar o c\xf3digo em assembly, ler vari\xe1veis na mem\xf3ria, ler a stack, etc. \xc9 realmente essencial para se trabalhar com rev."]}),"\n",(0,o.jsx)(n.p,{children:"Normalmente, o combo \xe9 Ghidra + GDB: Abra o Ghidra para ter uma ideia do que o c\xf3digo faz e use o GDB para tentar explorar as vulnerabilidades e analisar o bin\xe1rio em execu\xe7\xe3o."}),"\n",(0,o.jsx)(n.h2,{id:"instalando-e-executando",children:"Instalando e executando"}),"\n",(0,o.jsxs)(n.p,{children:["H\xe1 tr\xeas vers\xf5es do ",(0,o.jsx)(n.code,{children:"gdb"}),". O ",(0,o.jsx)(n.code,{children:"gdb"})," cl\xe1ssico j\xe1 vem instalado junto com o compilador do C ou C++."]}),"\n",(0,o.jsxs)(n.p,{children:["O ",(0,o.jsx)(n.code,{children:"gdb-gef"})," (gdb enhanced features), por sua vez, extende as funcionalidades do  ",(0,o.jsx)(n.code,{children:"gdb"})," padr\xe3o, e \xe9 muito mais \xfatil para an\xe1lise de software por engenharia reversa. Essa \xe9 a vers\xe3o utilizado no tutorial do nightmare, por isso abordei ela aqui. O reposit\xf3rio do projeto pode ser encontrado ",(0,o.jsx)(n.a,{href:"https://github.com/hugsy/gef",children:"aqui"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Baixe o ",(0,o.jsx)(n.code,{children:"gdb-gef"})," com: ",(0,o.jsx)(n.code,{children:'bash -c "$(wget https://gef.blah.cat/sh -O -)"'})]}),"\n",(0,o.jsxs)(n.p,{children:["E execute com: ",(0,o.jsx)(n.code,{children:"gdb ./meu_binario"})]}),"\n",(0,o.jsxs)(n.p,{children:["J\xe1 a terceira vers\xe3o \xe9 o ",(0,o.jsx)(n.code,{children:"pwndbg"}),", que provavelmente \xe9 a melhor das tr\xeas, e a mais completa. O reposit\xf3rio do ",(0,o.jsx)(n.code,{children:"pwndbg"})," pode ser encontrado ",(0,o.jsx)(n.a,{href:"https://github.com/pwndbg/pwndbg?tab=readme-ov-file",children:"aqui"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Baixe o ",(0,o.jsx)(n.code,{children:"pwndbg-gdb"})," com: ",(0,o.jsx)(n.code,{children:"curl -qsL 'https://install.pwndbg.re' | sh -s -- -t pwndbg-gdb"})]}),"\n",(0,o.jsxs)(n.p,{children:["E execute com: ",(0,o.jsx)(n.code,{children:"pwndbg ./meu_binario"})]}),"\n",(0,o.jsx)(n.h2,{id:"como-usar",children:"Como usar"}),"\n",(0,o.jsx)(n.p,{children:"O intuito do GDB \xe9 parar a execu\xe7\xe3o do programa em certos lugares, analisar e prosseguir."}),"\n",(0,o.jsx)(n.p,{children:"Para navegar na execu\xe7\xe3o do programa no GDB:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"continue"})," -  Para somente em breakpoints e no fim do programa"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"next"})," - Linha por linha, mas pula chamadas de fun\xe7\xe3o como puts"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"step"}),"  - Linha por linha, mas entra em chamadas de fun\xe7\xe3o"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"stepi"}),"  - Instru\xe7\xe3o por instru\xe7\xe3o, entrando em chamadas de fun\xe7\xe3o"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Para ver uma fun\xe7\xe3o em assembly, digite ",(0,o.jsx)(n.code,{children:"disassemble"})," (ou ",(0,o.jsx)(n.code,{children:"disass"}),") mais o nome da fun\xe7\xe3o. Vamos dar um disassemble (ou seja, ver o c\xf3digo em assembly) da main:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"disass main"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:"gef\u27a4  disass main\r\nDump of assembler code for function main:\r\n   0x080483fb <+0>:\tlea    ecx,[esp+0x4]\r\n   0x080483ff <+4>:\tand    esp,0xfffffff0\r\n   0x08048402 <+7>:\tpush   DWORD PTR [ecx-0x4]\r\n   0x08048405 <+10>:\tpush   ebp\r\n   0x08048406 <+11>:\tmov    ebp,esp\r\n   0x08048408 <+13>:\tpush   ecx\r\n   0x08048409 <+14>:\tsub    esp,0x4\r\n   0x0804840c <+17>:\tsub    esp,0xc\r\n   0x0804840f <+20>:\tpush   0x80484b0\r\n   0x08048414 <+25>:\tcall   0x80482d0 <puts@plt>\r\n   0x08048419 <+30>:\tadd    esp,0x10\r\n   0x0804841c <+33>:\tmov    eax,0x0\r\n   0x08048421 <+38>:\tmov    ecx,DWORD PTR [ebp-0x4]\r\n   0x08048424 <+41>:\tleave  \r\n   0x08048425 <+42>:\tlea    esp,[ecx-0x4]\r\n   0x08048428 <+45>:\tret    \r\nEnd of assembler dump.\n"})}),"\n",(0,o.jsx)(n.h3,{id:"breakpoints",children:"Breakpoints"}),"\n",(0,o.jsxs)(n.p,{children:["No GDB podemos usar breakpoints, que s\xe3o lugares onde o GDB ",(0,o.jsx)(n.strong,{children:"para a execu\xe7\xe3o"})," para permitir examinar o programa. O mais comum \xe9 colocarmos o ",(0,o.jsx)(n.strong,{children:"primeiro breakpoint na main"})," (a fun\xe7\xe3o principal que cont\xe9m todo o c\xf3digo fonte). Podemos colocar ",(0,o.jsx)(n.code,{children:"break main"}),"  ou ",(0,o.jsx)(n.code,{children:"b main"})," ."]}),"\n",(0,o.jsx)(n.p,{children:"Agora, suponha que queremos dar um break na call do puts (fun\xe7\xe3o que imprime texto na tela), podemos fazer isso colocando um breakpoint para a instru\xe7\xe3o:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"b *main+25"})," (+25 \xe9 relativo ao in\xedcio do c\xf3digo) ou ",(0,o.jsx)(n.code,{children:"b *0x08048414"})," (endere\xe7o de mem\xf3ria da instru\xe7\xe3o)"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Ainda n\xe3o rodamos o bin\xe1rio"}),", apenas estabelecemos onde o GDB deve parar para que possamos analisar o c\xf3digo. Quando rodarmos o bin\xe1rio, o processo vai pausar e mostrar o debugger exatamente na instru\xe7\xe3o assembly onde colocamos os breakpoints (quando colocamos um breakpoint em uma fun\xe7\xe3o, paramos exatamente na primeira instru\xe7\xe3o dela)."]}),"\n",(0,o.jsxs)(n.p,{children:["Para ",(0,o.jsx)(n.strong,{children:"executar o c\xf3digo desde o come\xe7o"}),", execute ",(0,o.jsx)(n.code,{children:"run"})," (ou ",(0,o.jsx)(n.code,{children:"r"}),"). Isso vai parar no primeiro breakpoint. Para ",(0,o.jsx)(n.strong,{children:"prosseguir"}),", execute ",(0,o.jsx)(n.code,{children:"continue"})," (ou ",(0,o.jsx)(n.code,{children:"c"}),"). Esse comando continua a execu\xe7\xe3o at\xe9 encontrar um breakpoint, fim do programa ou sinal (como segfault)."]}),"\n",(0,o.jsx)(n.p,{children:"Para mostrar os breakpoints que colocamos:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"info breakpoints"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Para deletar um breakpoint:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"delete 2"}),"  ou ",(0,o.jsx)(n.code,{children:"d 2"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Podemos colocar breakpoints em fun\xe7\xf5es como ",(0,o.jsx)(n.code,{children:"puts"})," :"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"b *puts"})," (* significa endere\xe7o)  e ",(0,o.jsx)(n.code,{children:"run"})]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"console-de-debug",children:"Console de debug"}),"\n",(0,o.jsxs)(n.p,{children:["Quando rodamos o bin\xe1rio com ",(0,o.jsx)(n.code,{children:"run"})," e o GDB tenta executar a instru\xe7\xe3o na qual colocamos o break, o processo vai pausar e dropar na ela o ",(0,o.jsx)(n.strong,{children:"console de debug"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:'gef\u27a4  r\r\nStarting program: /home/devey/nightmare/modules/02-intro_tooling/hello_world \r\n[ Legend: Modified register | Code | Heap | Stack | String ]\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 registers \u2500\u2500\u2500\u2500\r\n$eax   : 0xf7fb9dd8  \u2192  0xffffd19c  \u2192  0xffffd389  \u2192  "CLUTTER_IM_MODULE=xim"\r\n$ebx   : 0x0       \r\n$ecx   : 0xffffd100  \u2192  0x00000001\r\n$edx   : 0xffffd124  \u2192  0x00000000\r\n$esp   : 0xffffd0d0  \u2192  0x080484b0  \u2192  "hello world!"\r\n$ebp   : 0xffffd0e8  \u2192  0x00000000\r\n$esi   : 0xf7fb8000  \u2192  0x001d4d6c\r\n$edi   : 0x0       \r\n$eip   : 0x08048414  \u2192  0xfffeb7e8  \u2192  0x00000000\r\n$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]\r\n$cs: 0x0023 $ss: 0x002b $ds: 0x002b $es: 0x002b $fs: 0x0000 $gs: 0x0063 \r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 stack \u2500\u2500\u2500\u2500\r\n0xffffd0d0\u2502+0x0000: 0x080484b0  \u2192  "hello world!"\t \u2190 $esp\r\n0xffffd0d4\u2502+0x0004: 0xffffd194  \u2192  0xffffd34e  \u2192  "/home/devey/nightmare/modules/02-intro_tooling/hel[...]"\r\n0xffffd0d8\u2502+0x0008: 0xffffd19c  \u2192  0xffffd389  \u2192  "CLUTTER_IM_MODULE=xim"\r\n0xffffd0dc\u2502+0x000c: 0x08048451  \u2192  <__libc_csu_init+33> lea eax, [ebx-0xf8]\r\n0xffffd0e0\u2502+0x0010: 0xf7fe59b0  \u2192   push ebp\r\n0xffffd0e4\u2502+0x0014: 0xffffd100  \u2192  0x00000001\r\n0xffffd0e8\u2502+0x0018: 0x00000000\t \u2190 $ebp\r\n0xffffd0ec\u2502+0x001c: 0xf7dfbe81  \u2192  <__libc_start_main+241> add esp, 0x10\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 code:x86:32 \u2500\u2500\u2500\u2500\r\n    0x8048409 <main+14>        sub    esp, 0x4\r\n    0x804840c <main+17>        sub    esp, 0xc\r\n    0x804840f <main+20>        push   0x80484b0\r\n \u2192  0x8048414 <main+25>        call   0x80482d0 <puts@plt>\r\n   \u21b3   0x80482d0 <puts@plt+0>     jmp    DWORD PTR ds:0x80496bc\r\n       0x80482d6 <puts@plt+6>     push   0x0\r\n       0x80482db <puts@plt+11>    jmp    0x80482c0\r\n       0x80482e0 <__gmon_start__@plt+0> jmp    DWORD PTR ds:0x80496c0\r\n       0x80482e6 <__gmon_start__@plt+6> push   0x8\r\n       0x80482eb <__gmon_start__@plt+11> jmp    0x80482c0\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 arguments (guessed) \u2500\u2500\u2500\u2500\r\nputs@plt (\r\n   [sp + 0x0] = 0x080484b0 \u2192 "hello world!",\r\n   [sp + 0x4] = 0xffffd194 \u2192 0xffffd34e \u2192 "/home/devey/nightmare/modules/02-intro_tooling/hel[...]"\r\n)\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 threads \u2500\u2500\u2500\u2500\r\n[#0] Id 1, Name: "hello_world", stopped 0x8048414 in main (), reason: BREAKPOINT\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 trace \u2500\u2500\u2500\u2500\r\n[#0] 0x8048414 \u2192 main()\r\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nBreakpoint 1, 0x08048414 in main ()\r\ngef\u27a4  \n'})}),"\n",(0,o.jsx)(n.p,{children:"O console de debug se divide em abas. Veremos o que cada uma mostra de informa\xe7\xe3o."}),"\n",(0,o.jsx)(n.h4,{id:"registers",children:"Registers"}),"\n",(0,o.jsx)(n.p,{children:"Aqui podemos ver o conte\xfado dos registradores da CPU. Eles ser\xe3o usados o tempo inteiro."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:'\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 registers \u2500\u2500\u2500\u2500\r\n$eax   : 0xf7fb9dd8  \u2192  0xffffd19c  \u2192  0xffffd389  \u2192  "CLUTTER_IM_MODULE=xim"\r\n$ebx   : 0x0       \r\n$ecx   : 0xffffd100  \u2192  0x00000001\r\n$edx   : 0xffffd124  \u2192  0x00000000\r\n$esp   : 0xffffd0d0  \u2192  0x080484b0  \u2192  "hello world!"\r\n$ebp   : 0xffffd0e8  \u2192  0x00000000\r\n$esi   : 0xf7fb8000  \u2192  0x001d4d6c\r\n$edi   : 0x0       \r\n$eip   : 0x08048414  \u2192  0xfffeb7e8  \u2192  0x00000000\r\n$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]\r\n$cs: 0x0023 $ss: 0x002b $ds: 0x002b $es: 0x002b $fs: 0x0000 $gs: 0x0063 \n'})}),"\n",(0,o.jsx)(n.p,{children:"No exemplo acima, temos, por exemplo:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:'$eax: 0xf7fb9dd8 \u2192 0xffffd19c \u2192 0xffffd389 \u2192 "CLUTTER_IM_MODULE=xim"'}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"eax"})," cont\xe9m o endere\xe7o ",(0,o.jsx)(n.code,{children:"0xf7fb9dd8"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xf7fb9dd8"})," cont\xe9m o endere\xe7o ",(0,o.jsx)(n.code,{children:"0xffffd19c"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd19c"})," cont\xe9m o endere\xe7o ",(0,o.jsx)(n.code,{children:"0xffffd389"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd389"}),' cont\xe9m a a string "',(0,o.jsx)(n.code,{children:"CLUTTER_IM_MODULE=xim"}),'" (processos internos n\xe3o relevantes do C)']}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"$ebx"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"0x0 - Vazio"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:'$esp (stack pointer): 0xffffd0d0 \u2192 0x080484b0 \u2192 "hello world!"'}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"esp"})," cont\xe9m o endere\xe7o ",(0,o.jsx)(n.code,{children:"0xffffd0d0"})," (topo da stack atual)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd0d0"})," cont\xe9m o endere\xe7o ",(0,o.jsx)(n.code,{children:"0x080484b0"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0x080484b0"}),' aponta para a string "Hello World!"']}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"$ebp (base stack pointer): 0xffffd0e8  \u2192  0x00000000"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ebp"})," cont\xe9m o endere\xe7o 0xffffd0e8 (base da stack atual)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd0e8"})," cont\xe9m o valor 0x0 (zero)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Al\xe9m disso, temos o ",(0,o.jsx)(n.strong,{children:"registrador com as flags"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Se a flag \xe9 mostrada, seu valor \xe9 1. Se n\xe3o for mostrada, seu valor \xe9 0. Como, por exemplo:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"zero"})," aparece - \xdaltima opera\xe7\xe3o resultou em zero"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"stack",children:"Stack"}),"\n",(0,o.jsx)(n.p,{children:"A stack \xe9 um dos pontos mais importantes do programa, pois uma s\xe9rie de vulnerabilidades envolvem explorar a maneira como a stack funciona. Nela estar\xe3o as vari\xe1veis locais, chamadas de fun\xe7\xe3o, retorno, etc."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 stack \u2500\u2500\u2500\u2500\r\nEndere\xe7o    Offset  Valor \u2192 Conte\xfado\r\n0xffffd0d0\u2502+0x0000: 0x080484b0  \u2192  "hello world!"\t \u2190 $esp\r\n0xffffd0d4\u2502+0x0004: 0xffffd194  \u2192  0xffffd34e  \u2192  "/home/devey/nightmare/modules/02-intro_tooling/hel[...]"\r\n0xffffd0d8\u2502+0x0008: 0xffffd19c  \u2192  0xffffd389  \u2192  "CLUTTER_IM_MODULE=xim"\r\n0xffffd0dc\u2502+0x000c: 0x08048451  \u2192  <__libc_csu_init+33> lea eax, [ebx-0xf8]\r\n0xffffd0e0\u2502+0x0010: 0xf7fe59b0  \u2192   push ebp\r\n0xffffd0e4\u2502+0x0014: 0xffffd100  \u2192  0x00000001\r\n0xffffd0e8\u2502+0x0018: 0x00000000\t \u2190 $ebp\r\n0xffffd0ec\u2502+0x001c: 0xf7dfbe81  \u2192  <__libc_start_main+241> add esp, 0x10\n'})}),"\n",(0,o.jsx)(n.p,{children:"Acima, podemos ver:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsxs)(n.strong,{children:[(0,o.jsx)(n.code,{children:'0xffffd0d0\u2502+0x0000: 0x080484b0 \u2192 "hello world!"    \u2190 $esp'})," (topo da stack)"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"$esp"})," est\xe1 apontando para este endere\xe7o, ",(0,o.jsx)(n.code,{children:"0xffffd0d0"}),". Lembra que o mesmo endere\xe7o estava nos registradores ",(0,o.jsx)(n.code,{children:"$esp"}),", visto anteriormente?"]}),"\n",(0,o.jsxs)(n.li,{children:["Mesmo que seja o primeiro valor a ser mostrado, esse \xe9 o ",(0,o.jsx)(n.strong,{children:"topo da stack"}),". Lembre-se que ",(0,o.jsxs)(n.strong,{children:[(0,o.jsx)(n.code,{children:"$esp"})," sempre aponta para o topo da stack"]}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Temos um offset ",(0,o.jsx)(n.strong,{children:"+0x0000"}),". Isso quer dizer quantos bytes estamos longe do primeiro endere\xe7o, ",(0,o.jsx)(n.code,{children:"0xffffd0d0"})," (topo da stack)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd0d0"})," (endere\xe7o da stack) cont\xe9m ",(0,o.jsx)(n.code,{children:"0x080484b0"}),', que aponta para a string "Hello World!".']}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"0xffffd0e8\u2502+0x0018: 0x00000000\t \u2190 $ebp"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"$ebp"})," aponta para este endere\xe7o da stack, ",(0,o.jsx)(n.code,{children:"0xffffd0e8"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"0xffffd0e8"})," contem ",(0,o.jsx)(n.code,{children:"0x0"}),", ou seja, zero. Isso indica que \xe9 um valor nulo (",(0,o.jsx)(n.strong,{children:"n\xe3o h\xe1 ebp salvo"}),", o que indica que n\xe3o havia fun\xe7\xe3o anterior com stack e vari\xe1veis locais para a qual o c\xf3digo ir\xe1 voltar. Isso \xe9 v\xe1lido, j\xe1 que estamos na fun\xe7\xe3o principal, a ",(0,o.jsx)(n.strong,{children:"main"}),")"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"0xffffd0ec\u2502+0x001c: 0xf7dfbe81  \u2192  <__libc_start_main+241> add esp, 0x10"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Note que estamos falando de registradores com prefixo ",(0,o.jsx)(n.code,{children:"e"}),", ou seja, x86 = 32 bits. ",(0,o.jsx)(n.strong,{children:"Isso significa que a stack est\xe1 de 4 em 4 bytes"}),", como podemos ver. Isso tamb\xe9m quer dizer que o ",(0,o.jsx)(n.strong,{children:"endere\xe7o de retorno para a fun\xe7\xe3o anterior"})," sempre estar\xe1 em ",(0,o.jsx)(n.strong,{children:"ebp+0x4"}),". E c\xe1 estamos. em ",(0,o.jsx)(n.code,{children:"0xffffd0e8"})," temos ",(0,o.jsx)(n.code,{children:"ebp"}),", e em ",(0,o.jsx)(n.code,{children:"0xffffd0ec"})," (",(0,o.jsx)(n.code,{children:"0xffffd0ec + 0x4"}),") temos o endere\xe7o da fun\xe7\xe3o ",(0,o.jsx)(n.code,{children:"<__libc_start_main+241>"}),". Esta \xe9 a fun\xe7\xe3o que inicializa a main."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Note tamb\xe9m que a ",(0,o.jsx)(n.strong,{children:"stack realmente cresce negativamente"}),", indo desde endere\xe7os mais altos (",(0,o.jsx)(n.code,{children:"ebp"}),") at\xe9 endere\xe7os mais baixos (",(0,o.jsx)(n.code,{children:"esp"}),")."]}),"\n",(0,o.jsx)(n.h4,{id:"code",children:"Code"}),"\n",(0,o.jsxs)(n.p,{children:["\xc9 aqui onde fica o ",(0,o.jsx)(n.strong,{children:"c\xf3digo em Assembly"}),". Em cima podemos ver a arquitetura do programa: x86 = 32 bits, ou 4 bytes."]}),"\n",(0,o.jsxs)(n.p,{children:["A ",(0,o.jsx)(n.strong,{children:"setinha"})," mostra em qual instru\xe7\xe3o paramos (esta instru\xe7\xe3o ",(0,o.jsx)(n.strong,{children:"n\xe3o foi executada ainda, mas ser\xe1 a pr\xf3xima"})," a ser executada)."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 code:x86:32 \u2500\u2500\u2500\u2500\r\n    0x8048409 <main+14>        sub    esp, 0x4\r\n    0x804840c <main+17>        sub    esp, 0xc\r\n    0x804840f <main+20>        push   0x80484b0\r\n \u2192  0x8048414 <main+25>        call   0x80482d0 <puts@plt>\r\n   \u21b3   0x80482d0 <puts@plt+0>     jmp    DWORD PTR ds:0x80496bc\r\n       0x80482d6 <puts@plt+6>     push   0x0\r\n       0x80482db <puts@plt+11>    jmp    0x80482c0\r\n       0x80482e0 <__gmon_start__@plt+0> jmp    DWORD PTR ds:0x80496c0\r\n       0x80482e6 <__gmon_start__@plt+6> push   0x8\r\n       0x80482eb <__gmon_start__@plt+11> jmp    0x80482c0\n"})}),"\n",(0,o.jsx)(n.h4,{id:"arguments-guessed",children:"Arguments (guessed)"}),"\n",(0,o.jsx)(n.p,{children:"Essa aba aparece quando o GDB deduz que uma fun\xe7\xe3o est\xe1 preste a ser chamada."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:'\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 arguments (guessed) \u2500\u2500\u2500\u2500\r\nputs@plt (\r\n   [sp + 0x0] = 0x080484b0 \u2192 "hello world!",\r\n   [sp + 0x4] = 0xffffd194 \u2192 0xffffd34e \u2192 "/home/devey/nightmare/modules/02-intro_tooling/hel[...]"\r\n)\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:'[sp + 0x0] = 0x080484b0 \u2192 "hello world!"'}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Primeiro argumento (",(0,o.jsx)(n.code,{children:"sp+0"}),"). Est\xe1 em ",(0,o.jsx)(n.code,{children:"$esp+0x0"}),", que \xe9 o ponteiro ",(0,o.jsx)(n.code,{children:"0x080484b0"}),' que aponta para a string "hello world".']}),"\n",(0,o.jsxs)(n.li,{children:["Segundo argumento (",(0,o.jsx)(n.code,{children:"sp+4"}),"). Provavelmente \xe9 um artefato na stack (lixo de mem\xf3ria), e n\xe3o um argumento real, pois ",(0,o.jsx)(n.code,{children:"puts()"})," s\xf3 recebe um argumento (a string)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"threads",children:"Threads"}),"\n",(0,o.jsx)(n.p,{children:"Exibe informa\xe7\xf5es de threads relacionadas ao sistema operacional."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'[#0] Id 1, Name: "hello_world", stopped 0x8048414 in main (), reason: BREAKPOINT\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"#0"})," - Thread n\xfamero 0 (thread principal)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"id 1"})," - ID do thread no sistema operacional"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:'Name: "hello_world"'})," - Nome do programa/thread"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"stopped 0x8048414 in main ()"})," - Parado no endere\xe7o 0x8048414 na fun\xe7\xe3o main()"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"reason: BREAKPOINT"})," - Motivo da parada: breakpoint atingido"]}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"trace",children:"Trace"}),"\n",(0,o.jsx)(n.p,{children:"Backtrace da execu\xe7\xe3o. Mostra pilha de chamadas (call stack)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 trace \u2500\u2500\u2500\u2500\r\n[#0] 0x8048414 \u2192 main()\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"#0"})," - Frame atual: executando ",(0,o.jsx)(n.code,{children:"main()"})," no endere\xe7o 0x8048414"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Se houvesse mais fun\xe7\xf5es, mostraria algo como:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"[#0] 0x... \u2192 fun\xe7\xe3o_atual()\r\n[#1] 0x... \u2192 fun\xe7\xe3o_chamadora()\r\n[#2] 0x... \u2192 main()\n"})}),"\n",(0,o.jsx)(n.h3,{id:"visualizando",children:"Visualizando"}),"\n",(0,o.jsxs)(n.p,{children:["\xc9 poss\xedvel ver que o registrador ",(0,o.jsx)(n.code,{children:"esp"}),"  armazena o valor ",(0,o.jsx)(n.code,{children:"0xffffd0d0"})," , que \xe9 um ponteiro. (vis\xedvel no come\xe7o, na aba de registradores)"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nasm",children:'$esp   : 0xffffd0d0  \u2192  0x080484b0  \u2192  "hello world!"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Para examinar as coisas com ",(0,o.jsx)(n.code,{children:"x"})," , voc\xea tem que especificar o que vai ser examinado, e ele mostra o conte\xfado:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"x/a"})," - Endere\xe7o, ",(0,o.jsx)(n.code,{children:"x/10c"})," - N\xfamero de caracteres, ",(0,o.jsx)(n.code,{children:"x/s"}),"  - String, ",(0,o.jsx)(n.code,{children:"x/g"}),"  - Qword, ",(0,o.jsx)(n.code,{children:"x/w"}),"  - Dword"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Para visualizar o conte\xfado dos registradores:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"info registers"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Para ver o stack frame (se\xe7\xe3o da stack alocada para uma \xfanica fun\xe7\xe3o)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"info frame"})}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"mudando-valores",children:"Mudando valores"}),"\n",(0,o.jsxs)(n.p,{children:["Se quisermos mudar o valor armazenado em ",(0,o.jsx)(n.code,{children:"0x08048451"}),"  para ",(0,o.jsx)(n.code,{children:"0xfacade"})," :"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"set 0x08048451 = 0xfacade"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Assim, podemos manipular o c\xf3digo do jeito que quisermos."}),"\n",(0,o.jsx)(n.h2,{id:"arquivos-compilados-e-debugging-symbols",children:"Arquivos compilados e Debugging symbols"}),"\n",(0,o.jsxs)(n.p,{children:["Debugging symbols s\xe3o ",(0,o.jsx)(n.strong,{children:"metadados"})," embutidos no arquivo execut\xe1vel (bin\xe1rio) que fornecem ",(0,o.jsx)(n.strong,{children:"informa\xe7\xf5es de mapeamento entre o c\xf3digo bin\xe1rio e o c\xf3digo fonte original"}),". Caso essas informa\xe7\xf5es n\xe3o estejam presentes no arquivo, a an\xe1lise fica um pouco mais dif\xedcil, pois perdemos algumas informa\xe7\xf5es."]}),"\n",(0,o.jsx)(n.h3,{id:"compilando-com--g",children:"Compilando com -g"}),"\n",(0,o.jsxs)(n.p,{children:["No comando abaixo, estamos compilando o arquivo ",(0,o.jsx)(n.code,{children:"main.c"}),", que pode ser qualquer coisa, como um simples ",(0,o.jsx)(n.code,{children:'printf("Hello World!")'}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"gcc -g -o meu_programa main.c\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Note que usamos a op\xe7\xe3o ",(0,o.jsx)(n.code,{children:"-g"}),". Essa op\xe7\xe3o ",(0,o.jsx)(n.strong,{children:"ativa os metadados de Debugging Symbols"}),". \xc9 bem \xfatil para desenvolvimento de programas, de modo que fica mais f\xe1cil debugar o c\xf3digo."]}),"\n",(0,o.jsxs)(n.p,{children:["Ao usar ",(0,o.jsx)(n.code,{children:"-g"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Inclui informa\xe7\xf5es de debugging no execut\xe1vel"}),"\n",(0,o.jsx)(n.li,{children:"Mapeamento completo entre c\xf3digo fonte e assembly"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Debug Symbol: \r\nEndere\xe7o 0x8048410 \u2192 programa.c:15 (linha no c\xf3digo fonte)\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Nomes de vari\xe1veis, fun\xe7\xf5es, structs s\xe3o preservados"}),"\n",(0,o.jsx)(n.li,{children:"Arquivo maior em tamanho"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Comandos principais navegar no GDB em um execut\xe1vel com ",(0,o.jsx)(n.code,{children:"-g"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"(gdb) list              # Mostra c\xf3digo fonte\r\n(gdb) break main        # Breakpoint por nome de fun\xe7\xe3o\r\n(gdb) break 10          # Breakpoint por linha\r\n(gdb) print variavel    # Mostra valor de vari\xe1veis\r\n(gdb) next              # Pr\xf3xima linha de c\xf3digo\r\n(gdb) step              # Entra em fun\xe7\xf5es\r\n(gdb) info locals       # Vari\xe1veis locais\r\n(gdb) info args         # Argumentos da fun\xe7\xe3o\n"})}),"\n",(0,o.jsx)(n.h3,{id:"compilando-sem--g",children:"Compilando sem -g"}),"\n",(0,o.jsxs)(n.p,{children:["Sem ",(0,o.jsx)(n.code,{children:"-g"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Sem informa\xe7\xf5es de debugging"}),"\n",(0,o.jsx)(n.li,{children:"Apenas c\xf3digo execut\xe1vel"}),"\n",(0,o.jsx)(n.li,{children:"Arquivo menor e otimizado"}),"\n",(0,o.jsxs)(n.li,{children:["Uso de strip adicional: ",(0,o.jsx)(n.code,{children:"strip program"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Comandos principais navegar no GDB em um execut\xe1vel sem ",(0,o.jsx)(n.code,{children:"-g"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"(gdb) break *0x8048400    # Breakpoint por endere\xe7o\r\n(gdb) info functions      # Lista fun\xe7\xf5es (limitado)\r\n(gdb) disas main          # Disassembly da fun\xe7\xe3o\r\n(gdb) nexti               # Pr\xf3xima instru\xe7\xe3o assembly\r\n(gdb) stepi               # Entra em calls\r\n(gdb) info registers      # Registradores\r\n(gdb) x/10i $eip          # Examina instru\xe7\xf5es\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\xc9 importante tamb\xe9m saber que ",(0,o.jsx)(n.strong,{children:"alguns comandos n\xe3o funcionam"})," quando o programa \xe9 compilado sem ",(0,o.jsx)(n.code,{children:"-g"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"break linha_codigo_fonte"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"print vari\xe1vel"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"next"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"info locals"})}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"compilando-sem--g--stripped",children:"Compilando sem -g + stripped"}),"\n",(0,o.jsxs)(n.p,{children:["Outra ocasi\xe3o \xe9 quando o arquivo foi completamente ",(0,o.jsx)(n.code,{children:"stripped"})," - Todos os s\xedmbolos foram removidos, incluindo os s\xedmbolos b\xe1sicos das fun\xe7\xf5es. As fun\xe7\xf5es perdem seus nomes, inclusive a ",(0,o.jsx)(n.code,{children:"main"}),". Assim, ",(0,o.jsx)(n.code,{children:"b main"})," n\xe3o ir\xe1 funcionar."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"gcc -o teste teste.c\r\nstrip --strip-all teste\n"})}),"\n",(0,o.jsx)(n.p,{children:"Antes do strip, t\xednhamos algumas se\xe7\xf5es no execut\xe1vel:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:".text    \u2192 C\xf3digo execut\xe1vel\r\n.data    \u2192 Dados inicializados  \r\n.rodata  \u2192 Strings constantes\r\n.symtab  \u2192 Tabela de s\xedmbolos\r\n.strtab  \u2192 Tabela de strings\n"})}),"\n",(0,o.jsx)(n.p,{children:"Depois do strip, sobra apenas:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:".text      (c\xf3digo ainda funciona)\r\n.data   \r\n.rodata \n"})}),"\n",(0,o.jsx)(n.p,{children:"Para navegar com o GDB em arquivos assim, voc\xea ter\xe1 que usar o entry point:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"(gdb) break *entry_point\r\n(gdb) si/ni para navegar\n"})}),"\n",(0,o.jsx)(n.p,{children:"Entry point \xe9 o endere\xe7o de mem\xf3ria onde o sistema come\xe7a a executar um programa. \xc9 a primeira instru\xe7\xe3o do c\xf3digo que a ser executada."}),"\n",(0,o.jsx)(n.h3,{id:"verificando-n\xedvel-de-strip-de-um-bin\xe1rio",children:"Verificando n\xedvel de strip de um bin\xe1rio"}),"\n",(0,o.jsxs)(n.p,{children:["Para verificar, use o comando do ",(0,o.jsx)(n.code,{children:"file arquivo"})]}),"\n",(0,o.jsxs)(n.p,{children:["Com s\xedmbolos, no final haver\xe1 ",(0,o.jsx)(n.strong,{children:"not stripped"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, with debug_info, not stripped\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Sem s\xedmbolos com stripped parcial: ",(0,o.jsx)(n.code,{children:"..., stripped"})]}),"\n",(0,o.jsxs)(n.p,{children:["Completamente stripped: ",(0,o.jsx)(n.code,{children:"..., no symbols"})]}),"\n",(0,o.jsx)(n.h2,{id:"observa\xe7\xe3o-c\xf3digos-n\xe3o-iniciam-na-main",children:"Observa\xe7\xe3o: C\xf3digos n\xe3o iniciam na main"}),"\n",(0,o.jsxs)(n.p,{children:["Os c\xf3digos n\xe3o come\xe7am direto na fun\xe7\xe3o ",(0,o.jsx)(n.code,{children:"main"}),", que \xe9 a primeira que o programador escreve. Na verdade, primeiro temos:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Inicializa\xe7\xe3o do ambiente C"})," (Libc)","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Inicializar alocador de mem\xf3ria (malloc/free)"}),"\n",(0,o.jsx)(n.li,{children:"Configurar buffers de I/O (Input/Output) (stdin, stdout, stderr)"}),"\n",(0,o.jsx)(n.li,{children:"Inicializar vari\xe1veis globais da libc"}),"\n",(0,o.jsx)(n.li,{children:"Setup de localization (locale)"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Processamento de argumentos"})," (do kernel para main, por exemplo)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Inicializa\xe7\xe3o de vari\xe1veis globais"})," (fora da ",(0,o.jsx)(n.code,{children:"main"}),")"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"Construtores de objetos C++"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"Alinhamento e Setup da Stack"})}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Seguran\xe7a e ASLR"})," - H\xe1 algumas seguran\xe7as que dificultam a vida dos ganeshers como n\xf3s. Aprenderemos elas mais para frente."]}),"\n"]})]})}function t(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(x,{...e})}):x(e)}},8453(e,n,s){s.d(n,{R:()=>d,x:()=>a});var r=s(6540);const o={},i=r.createContext(o);function d(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);