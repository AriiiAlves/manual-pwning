"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[8580],{540(e,r,a){a.r(r),a.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"extra/shellcraft-li","title":"Principais Fun\xe7\xf5es Shellcraft","description":"Shell","source":"@site/docs/extra/shellcraft-li.mdx","sourceDirName":"extra","slug":"/extra/shellcraft-li","permalink":"/manual-pwning/docs/extra/shellcraft-li","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Principais Fun\xe7\xf5es Shellcraft"},"sidebar":"tutorialSidebar","previous":{"title":"Tabela de Syscalls para kernel Linux","permalink":"/manual-pwning/docs/extra/syscall-tb"},"next":{"title":"Conven\xe7\xe3o de chamada de fun\xe7\xf5es","permalink":"/manual-pwning/docs/extra/call-convention"}}');var s=a(4848),n=a(8453);const t={title:"Principais Fun\xe7\xf5es Shellcraft"},c=void 0,i={},o=[{value:"Shell",id:"shell",level:2},{value:"Redes e sockets",id:"redes-e-sockets",level:2},{value:"Arquivos",id:"arquivos",level:2},{value:"Processos",id:"processos",level:2},{value:"Sistema",id:"sistema",level:2},{value:"Mem\xf3ria e mapeamento",id:"mem\xf3ria-e-mapeamento",level:2},{value:"Espec\xedficos da arquitetura",id:"espec\xedficos-da-arquitetura",level:2},{value:"Modificadores e flags",id:"modificadores-e-flags",level:2},{value:"Outros",id:"outros",level:2}];function d(e){const r={code:"code",h2:"h2",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"shell",children:"Shell"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"# Shell\r\nshellcraft.sh()                    # /bin/sh\r\nshellcraft.dupsh()                 # Duplica shell para stdin/stdout\r\nshellcraft.dupsh('rbp')            # Duplica shell para fd espec\xedfico\r\nshellcraft.findsock()              # Encontra socket aberto\r\nshellcraft.findpeersh()            # Encontra peer shell (socket conectado)\r\nshellcraft.findpeersh('rbp')       # Com registro espec\xedfico\n"})}),"\n",(0,s.jsx)(r.h2,{id:"redes-e-sockets",children:"Redes e sockets"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"# Redes e sockets\r\n## Conex\xe3o\r\nshellcraft.connect('ip', port)\r\nshellcraft.connect('ip', port, 'af')    # Fam\xedlia de endere\xe7os\r\n\r\n## Bind shell\r\nshellcraft.bindsh(port)\r\nshellcraft.bindsh(port, 'af')           # Fam\xedlia de endere\xe7os\r\nshellcraft.bindshell(port)              # Alternativa\r\n\r\n## Reverse shell\r\nshellcraft.reverse('ip', port)\r\nshellcraft.reverse('ip', port, 'af')\r\n\r\n## Listener/Server\r\nshellcraft.listen(port)\r\nshellcraft.listen(port, 'af')\r\n\r\n## Socket operations\r\nshellcraft.sockopen()                   # Abre socket\r\nshellcraft.sockconnect()                # Conecta socket\r\nshellcraft.sockbind()                   # Bind socket\r\nshellcraft.socklisten()                 # Listen socket\r\nshellcraft.sockaccept()                 # Accept conex\xe3o\r\nshellcraft.sockdup()                    # Duplica socket\r\nshellcraft.socksend()                   # Envia dados\r\nshellcraft.sockrecv()                   # Recebe dados\n"})}),"\n",(0,s.jsx)(r.h2,{id:"arquivos",children:"Arquivos"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"## Opera\xe7\xf5es com arquivos\r\nshellcraft.cat('filename')           # L\xea arquivo\r\nshellcraft.cat('filename', fd)       # L\xea para fd espec\xedfico\r\nshellcraft.open('filename')          # Abre arquivo\r\nshellcraft.openat('filename')        # Openat syscall\r\nshellcraft.read(fd, size)            # L\xea de fd\r\nshellcraft.write(fd, 'data')         # Escreve em fd\r\nshellcraft.close(fd)                 # Fecha fd\r\n\r\n## Diret\xf3rios\r\nshellcraft.getdents(fd)              # Lista diret\xf3rio\r\nshellcraft.getdents64(fd)            # Lista diret\xf3rio (64-bit)\r\nshellcraft.getcwd()                  # Diret\xf3rio atual\r\nshellcraft.chdir('path')             # Muda diret\xf3rio\r\n\r\n## Manipula\xe7\xe3o de arquivos\r\nshellcraft.unlink('filename')        # Remove arquivo\r\nshellcraft.rename('old', 'new')      # Renomeia arquivo\r\nshellcraft.symlink('target', 'link') # Cria symlink\r\nshellcraft.link('old', 'new')        # Cria hard link\n"})}),"\n",(0,s.jsx)(r.h2,{id:"processos",children:"Processos"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"## Controle de processos\r\nshellcraft.fork()                    # Fork processo\r\nshellcraft.vfork()                   # vfork\r\nshellcraft.clone()                   # Clone processo\r\nshellcraft.execve('path', ['args'])  # Executa programa\r\nshellcraft.execveat('path', ['args']) # Execveat\r\n\r\n## Sair/terminar\r\nshellcraft.exit()                    # Sai normalmente\r\nshellcraft.exit(status)              # Sai com status\r\nshellcraft.kill(pid, sig)            # Mata processo\r\nshellcraft.tkill(tid, sig)           # Mata thread\n"})}),"\n",(0,s.jsx)(r.h2,{id:"sistema",children:"Sistema"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"## Informa\xe7\xf5es do sistema\r\nshellcraft.syscall()                 # Chama syscall arbitr\xe1ria\r\nshellcraft.getpid()                  # PID atual\r\nshellcraft.getppid()                 # PID do pai\r\nshellcraft.getuid()                  # UID real\r\nshellcraft.geteuid()                 # UID efetivo\r\nshellcraft.getgid()                  # GID real\r\nshellcraft.getegid()                 # GID efetivo\r\nshellcraft.uname()                   # Informa\xe7\xf5es do kernel\r\n\r\n## Time/Sleep\r\nshellcraft.sleep(seconds)            # Dorme por segundos\r\nshellcraft.nanosleep(seconds, nanos) # Dorme com nanosegundos\r\nshellcraft.alarm(seconds)            # Configura alarme\n"})}),"\n",(0,s.jsx)(r.h2,{id:"mem\xf3ria-e-mapeamento",children:"Mem\xf3ria e mapeamento"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"## Aloca\xe7\xe3o de mem\xf3ria\r\nshellcraft.mmap(addr, size, prot, flags)  # Mapeia mem\xf3ria\r\nshellcraft.munmap(addr, size)             # Desmapeia mem\xf3ria\r\nshellcraft.mprotect(addr, size, prot)     # Prote\xe7\xe3o de mem\xf3ria\r\nshellcraft.brk(addr)                      # Ajusta break heap\r\n\r\n## Stack operations\r\nshellcraft.push(value)                    # Empurra valor na stack\r\nshellcraft.pushstr('string')              # Empurra string\r\nshellcraft.pushstr_array(['str1', 'str2']) # Array de strings\r\nshellcraft.pusharray([1, 2, 3])           # Array de valores\r\n\r\n# I/O e redirecionamento\r\n## Duplica\xe7\xe3o de file descriptors\r\nshellcraft.dup(fd)                       # Duplica fd\r\nshellcraft.dup2(old, new)                # Duplica para fd espec\xedfico\r\nshellcraft.dup3(old, new, flags)         # Dup3 com flags\r\n\r\n## Pipes\r\nshellcraft.pipe()                        # Cria pipe\r\nshellcraft.pipe2(flags)                  # Pipe2 com flags\r\n\r\n## Terminal/PTY\r\nshellcraft.openpty()                     # Abre pseudo-terminal\r\nshellcraft.login_pty()                   # Login via PTY\n"})}),"\n",(0,s.jsx)(r.h2,{id:"espec\xedficos-da-arquitetura",children:"Espec\xedficos da arquitetura"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"shellcraft.i386.mov('eax', 0xdeadbeef)   # Move valor\r\nshellcraft.amd64.syscall()               # Syscall espec\xedfica\r\nshellcraft.arm.mov('r0', 0x1234)         # ARM\r\nshellcraft.aarch64.mov('x0', 0x1234)     # AArch64\r\nshellcraft.mips.mov('$a0', 0x1234)       # MIPS\r\nshellcraft.riscv.mv('a0', 0x1234)        # RISC-V\n"})}),"\n",(0,s.jsx)(r.h2,{id:"modificadores-e-flags",children:"Modificadores e flags"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"# Ajustar shellcodes\r\nshellcraft.setregs({'rax': 1, 'rbx': 2}) # Define registradores\r\nshellcraft.fixup()                       # Corrige offsets\r\n\r\n# Encoders\r\nshellcraft.encoder(shellcode)           # Codifica shellcode\r\nshellcraft.avoid(bytes)                 # Evita bytes espec\xedficos\n"})}),"\n",(0,s.jsx)(r.h2,{id:"outros",children:"Outros"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-py",children:"shellcraft.echo('text')                  # Imprime texto\r\nshellcraft.trap()                        # Instru\xe7\xe3o trap/debug\r\nshellcraft.int3()                        # Breakpoint (int 3)\r\nshellcraft.ud2()                         # Instru\xe7\xe3o undefined\r\nshellcraft.nop()                         # No operation\r\nshellcraft.ret()                         # Return\r\nshellcraft.infloop()                     # Loop infinito\r\n\r\n# Shellcodes compostos\r\nshellcraft.stager(url, size)             # Download e executa\r\nshellcraft.download(url, path)           # Download arquivo\r\nshellcraft.wget(url)                     # WGET-like\n"})})]})}function h(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,r,a){a.d(r,{R:()=>t,x:()=>c});var l=a(6540);const s={},n=l.createContext(s);function t(e){const r=l.useContext(n);return l.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(n.Provider,{value:r},e.children)}}}]);