"use strict";(globalThis.webpackChunkmanual_pwning_docs=globalThis.webpackChunkmanual_pwning_docs||[]).push([[3734],{1964(n,e,o){o.r(e),o.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"fast-food/introduction/pwntools","title":"Pwntools CheatSheet","description":"- Instala\xe7\xe3o: sudo pip install pwn","source":"@site/docs/fast-food/introduction/6-pwntools.md","sourceDirName":"fast-food/introduction","slug":"/fast-food/introduction/pwntools","permalink":"/manual-pwning/docs/fast-food/introduction/pwntools","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Pwntools CheatSheet"},"sidebar":"tutorialSidebar","previous":{"title":"GDB CheatSheet","permalink":"/manual-pwning/docs/fast-food/introduction/gdb"},"next":{"title":"Introdu\xe7\xe3o","permalink":"/manual-pwning/docs/fast-food/pwning/beginning"}}');var a=o(4848),t=o(8453);const s={title:"Pwntools CheatSheet"},i=void 0,c={},d=[];function l(n){const e={code:"code",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["Instala\xe7\xe3o: ",(0,a.jsx)(e.code,{children:"sudo pip install pwn"})]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Fluxo de uso:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["Estabelecer target (",(0,a.jsx)(e.code,{children:"remote"})," para servidores e ",(0,a.jsx)(e.code,{children:"process"})," para execut\xe1veis locais)"]}),"\n",(0,a.jsxs)(e.li,{children:["Enviar comandos iniciais ao programa com ",(0,a.jsx)(e.code,{children:"gdb.attach()"})," (j\xe1 estabelecemos os breakpoints e quaisquer outros comandos em ",(0,a.jsx)(e.code,{children:"gdbscript"}),")"]}),"\n",(0,a.jsxs)(e.li,{children:["Gerar dados, empacotar com ",(0,a.jsx)(e.code,{children:"p64()"})," ou ",(0,a.jsx)(e.code,{children:"p32()"})," e enviar com ",(0,a.jsx)(e.code,{children:"target.send()"})," ou ",(0,a.jsx)(e.code,{children:"target.sendline()"})]}),"\n",(0,a.jsxs)(e.li,{children:["Acesso manual com ",(0,a.jsx)(e.code,{children:"target.interactive()"})]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-py",children:"from pwn import *\r\n# Conecta a um servidor:porta ao inv\xe9s de faz\xea-lo no terminal\r\ntarget = remote(\"github.com\", 9000);\r\n# Roda um bin\xe1rio (programa!)\r\ntarget = process(\"./challenge\")\r\n# Adicionar o gdb debugger ao processo, dando um comando (b main e b my_function)\r\ngdb.attach(target, gdbscript='''\r\nb main\r\nb my_function')\r\n'''\r\n# Enviar vari\xe1vel x ao target como input\r\ntarget.send(x)\r\n# Enviar vari\xe1vel seguida de um \\n\r\ntarget.sendline(x)\r\n# Printar linha \xfanica de texto do target\r\nprint target.recvline()\r\n# Printar tudo do target at\xe9 a string desejada\r\nprint target.recvuntil(\"out\")\r\n'''\r\n- Arquivos ELFs (assembly) armazenam dados atrav\xe9s de least endian\r\n- Isso que significa que os dados s\xe3o armazenados com o byte menos significativo primeiro. (contra\u0155io)\r\n- (inteiro -> 0x109F D7B4 9C2D 0135 // Armazenado na mem\xf3ria -> 35 01 2D 9C B4 D7 9F 10)\r\n- Em algumas situa\xe7\xf5es em que escaneamos um inteiro, precisamos levar isso em conta.\r\n- Precisamos empacotar o inteiro (human readable -> bin\xe1rio)\r\n'''\r\n# Para empacotar n\xfamero inteiro como least endian (sequ\xeancia de bytes)\r\np64(x) # QWORD (x64 = 64 bits  = 8 bytes)\r\np32(x) # DWORD (x86 = 32 bits = 4 bytes)\r\n# Para desempacotar least endian (sequ\xeancia de bytes) como inteiro\r\nu64(x) # QWORD\r\nu32(x) # DWORD\r\n\r\n# Interage manualmente com o target no terminal\r\ntarget.interactive()\n"})}),"\n",(0,a.jsx)(e.p,{children:"Exemplo de endianness com pwntools:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-py",children:"# Big endian\r\np64(0x41424344, endian='big')  # b'\\x00\\x00\\x00\\x00ABCD'\r\nu64(b'ABCD\\x00\\x00\\x00\\x00', endian='big')  # 0x41424344\r\n\r\n# Little endian (padr\xe3o)\r\np64(0x41424344)  # b'DCBA\\x00\\x00\\x00\\x00'\r\n\n"})}),"\n",(0,a.jsxs)(e.p,{children:["Temos que trabalhar com ",(0,a.jsx)(e.code,{children:"b''"}),", um byteArray do python, e n\xe3o strings padr\xe3o ",(0,a.jsx)(e.code,{children:"''"}),". Isso cria uma sequ\xeancia de bytes no Python, essencial para trabalhar com bin\xe1rios, pois bin\xe1rios trabalham com bytes e n\xe3o strings. Comandos como ",(0,a.jsx)(e.code,{children:"p64"})," retornam byteArrays."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-py",children:"from pwn import *\r\n\r\n# Payload em bytes\r\npayload = b'A' * 64 + p64(0x401234)\r\nconn.send(payload)\n"})})]})}function m(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(l,{...n})}):l(n)}},8453(n,e,o){o.d(e,{R:()=>s,x:()=>i});var r=o(6540);const a={},t=r.createContext(a);function s(n){const e=r.useContext(t);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);